<!DOCTYPE html>
<html>
   <head>
      <title>Configuration Generator</title>
   </head>
   <body>
      <h1>Configuration Generator</h1>
      <table>
         <tbody><tr>
             <td><label for="weightInput">Weight for 3600 steps (in grams):</label></td>
             <td><input type="number" id="weightInput" step="0.0001" min="0" value="0.1"></td>
         </tr>
         <tr>
             <td><label for="speedInput">Stepper Speed:</label></td>
             <td><input type="number" id="speedInput" step="1" min="5" value="200"></td>
         </tr>
     </tbody></table>
     <button id="generateButton">Generate Configuration</button><br><br>

      <h2>Generated Configuration:</h2>
      <textarea id="configOutput" rows="20" cols="50"></textarea><br>
      <button id="copyButton">Copy</button>

      <script>
         document.getElementById("generateButton").addEventListener("click", function() {
             const measuredWeight = parseFloat(document.getElementById("weightInput").value) / 2;
             const speed = parseFloat(document.getElementById("speedInput").value);
             if (!isNaN(measuredWeight)) {
                 const config = {};

                 // Define the weight values for which you want to generate configurations
                 const weights = [1.0, 0.5, 0.25, 0.125, 0.062, 0.031, 0.015, 0.007, 0.003, 0.001];

                 var measurements = 2;

                 // Loop through each weight value and calculate the configuration
                 for (let i = 0; i < weights.length; i++) {
                     const weight = weights[i];
                     var steps = Math.round((weight / measuredWeight) * 360); // Assuming 0.1g is dispensed in 360 steps
                     if(i == weights.length-3)
                        measurements = 5;
                     if(i == weights.length-2)
                        measurements = 15;
                     if(i == weights.length-1)
                        measurements = 20;
                     config[i + 1] = {
                         weight: weight,
                         steps: steps,
                         speed: speed,
                         measurements: measurements
                     };
                 }

                 // Convert the config object to JSON format
                 const configJSON = JSON.stringify(config, null, 3);


                 document.getElementById("configOutput").value = configJSON;
             }
         });

         document.getElementById("copyButton").addEventListener("click", function() {
            // Get the text field
            var copyText = document.getElementById("configOutput");

            // Select the text field
            copyText.select();
            copyText.setSelectionRange(0, 99999); // For mobile devices

               // Copy the text inside the text field
            navigator.clipboard.writeText(copyText.value);
         });
      </script>
   </body>
</html>